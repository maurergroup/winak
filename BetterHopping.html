<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>BetterHopping &mdash; winak  documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="winak  documentation" href="index.html" />
    <link rel="next" title="Tutorial" href="Tutorial.html" />
    <link rel="prev" title="Installation Instructions" href="Installation.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">winak  documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="Installation.html" title="Installation Instructions"
             accesskey="P">previous</a> |
          <a href="Tutorial.html" title="Tutorial"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="betterhopping">
<h1>BetterHopping<a class="headerlink" href="#betterhopping" title="Permalink to this headline">¶</a></h1>
<p>BetterHopping is a variation of the Basinhopping algorithm <a class="reference internal" href="index.html#wales1" id="id1">[Wales1]</a>, <a class="reference internal" href="index.html#wales2" id="id2">[Wales2]</a>.
It makes use of delocalized internal coordinates to make global structure search more efficient.</p>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>All that is needed is a properly initialized ase.atoms object with a calculator:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.optimize</span> <span class="kn">import</span> <span class="n">BFGS</span>
<span class="kn">from</span> <span class="nn">winak.globaloptimization.betterhopping</span> <span class="kn">import</span> <span class="n">BetterHopping</span>
<span class="n">bh</span> <span class="o">=</span> <span class="n">BetterHopping</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="n">molecule</span><span class="p">,</span><span class="n">temperature</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">kB</span><span class="p">,</span>
                  <span class="n">dr</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
                  <span class="n">optimizer</span><span class="o">=</span><span class="n">BFGS</span><span class="p">,</span>
                  <span class="n">fmax</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span>
                  <span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;global.log&#39;</span><span class="p">,</span>
                  <span class="n">movemode</span><span class="o">=</span><span class="mi">1</span>
                  <span class="p">)</span>
<span class="n">bh</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="constructor-arguments">
<h2>Constructor Arguments<a class="headerlink" href="#constructor-arguments" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="winak.globaloptimization.BetterHopping">
<em class="property">class </em><code class="descclassname">winak.globaloptimization.</code><code class="descname">BetterHopping</code><span class="sig-paren">(</span><em>atoms</em>, <em>temperature=100*kB</em>, <em>optimizer=FIRE</em>, <em>optimizer2=FIRE</em>, <em>fmax=0.1</em>, <em>dr=0.1</em>, <em>logfile='-'</em>, <em>trajectory='lowest.traj'</em>, <em>optimizer_logfile='optim.log'</em>, <em>local_minima_trajectory='temp_local_minima.traj'</em>, <em>adjust_cm=True</em>, <em>movemode=0</em>, <em>maxmoves=10000</em>, <em>numdelocmodes=1</em>, <em>adsorb=None</em><span class="sig-paren">)</span><a class="headerlink" href="#winak.globaloptimization.BetterHopping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>BetterHopping Object</p>
<p>Performs the Basinhopping algorithm for a given <code class="xref py py-class docutils literal"><span class="pre">ase.atoms.Atoms</span></code> object.</p>
<p><strong>Parameters:</strong></p>
<dl class="docutils">
<dt>atoms: <code class="xref py py-class docutils literal"><span class="pre">ase.atoms.Atoms</span></code></dt>
<dd>A properly initialized <code class="xref py py-class docutils literal"><span class="pre">ase.atoms.Atoms</span></code> object with a calculator of your choice.</dd>
<dt>temperature: float or int</dt>
<dd>If the next displacement is performed from a new minimum (found after local optimization) or if the coordinates get set back to the previous one is determined by the following condition: <code class="docutils literal"><span class="pre">np.exp((Eo</span> <span class="pre">-</span> <span class="pre">En)</span> <span class="pre">/</span> <span class="pre">self.kT)</span> <span class="pre">&gt;</span> <span class="pre">np.random.uniform()</span></code>. Eo-En is the energy difference between the previous and the newly found minimum, kT is set to the temperature value given in the constructor. It should be specified in multiples of kB.</dd>
<dt>optimizer/optimizer2: <code class="xref py py-class docutils literal"><span class="pre">ase.optimize.optimize.Optimizer</span></code> derivative</dt>
<dd>Optimizer objects performing the local optimization. Convergence behaviour suggests the use of 2 different optimizers. One optimizer for regions far from the minimum (optimizer2) and one for regions close to the minimum (optimizer). It has proven useful to use <code class="xref py py-class docutils literal"><span class="pre">ase.optimize.fire.FIRE</span></code> for optimizer2 and <code class="xref py py-class docutils literal"><span class="pre">ase.optimize.BFGS</span></code> for the optimizer argument.</dd>
<dt>fmax: float</dt>
<dd>Local optimization is performed until the maximum residual force is smaller than the value specified for fmax in eV/Angstrom. The optimizer specified in the optimizer2 argument is used until the maximum residual force is smaller than 15 times fmax.</dd>
<dt>dr: float</dt>
<dd>This parameter is sometimes referred to as stepwidth. A displacement for the whole molecule is normed, so that the largest single change in a coordinate in x, y or z direction for any atom is at most 1 Angstrom. Afterwards the displacement is multiplied by the value specified for dr.</dd>
<dt>logfile: str</dt>
<dd>Stdout logfile name.</dd>
<dt>trajectory: str</dt>
<dd>Filename for trajectory file, which stores the most stable configuration.</dd>
<dt>optimizer_logfile: str</dt>
<dd>Optimizer logfile name.</dd>
<dt>local_minima_trajectory: str</dt>
<dd>Filename for trajectory file, which stores every minimum that was found.</dd>
<dt>adjust_cm: boolean</dt>
<dd>Determines whether or not a center of mass adjustment should be performed after a displacement.</dd>
<dt>movemode: int</dt>
<dd><blockquote class="first">
<div>Determines which kind of displacement will be performed.</div></blockquote>
<ul class="last simple">
<li>movemode=0: For every x, y and z coordinate of every atom a random number between -1.0 and +1.0 is generated and multiplied by the value specified for dr.</li>
<li>movemode=1: Delocalized coordinates are generated for the molecule and a displacement is performed along either 1 or a linear combination of multiple coordinates. The total displacement is normed, so that the largest single change in a coordinate in x, y or z direction for any atom is at most 1 Angstrom. Afterwards the displacement is multiplied by the value specified for dr.</li>
</ul>
</dd>
<dt>maxmoves: int</dt>
<dd>In rare cases, it is not possible to displace the structure in a minimum, without the optimizer or the calculator failing. This parameter helps avoid getting stuck at a certain minimum. After the specified amount of failed displacements the structure is reset to the last minimum.</dd>
<dt>numdelocmodes: int</dt>
<dd>If specified to a value above 1, this is the number of delocalized internal coordinates that are used in the linear combination for the displacement. Every coordinate used in the linear combination is multiplied by a random number between -1.0 and +1.0.</dd>
<dt>adsorb: list of 2 integers</dt>
<dd>If working with adsorbates, it is necessary to specify at what indices the adsorbate is found in the atoms object. Consider this example: The atoms object contains ammonia on a surface and the first 4 indices in the atoms object are of the adsorbed ammonia. The adsorbmask parameter would be set to (0,5).</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation Instructions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">BetterHopping</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constructor-arguments">Constructor Arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="winak.html">Modules</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="Installation.html" title="Installation Instructions"
              >previous</a> |
            <a href="Tutorial.html" title="Tutorial"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/BetterHopping.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Konstantin Krautgasser, Reinhard J. Maurer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>